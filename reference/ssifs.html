<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stochastic Search Inconsistency Factor Selection — ssifs • ssifs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Stochastic Search Inconsistency Factor Selection — ssifs"><meta name="description" content="Stochastic Search Inconsistency Factor Selection evaluates the consistency assumption of Network Meta-Analysis in the Bayesian framework,
by treating the inconsistency detection as a variable selection problem. The consistency assumption is evaluated locally, but also globally."><meta property="og:description" content="Stochastic Search Inconsistency Factor Selection evaluates the consistency assumption of Network Meta-Analysis in the Bayesian framework,
by treating the inconsistency detection as a variable selection problem. The consistency assumption is evaluated locally, but also globally."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ssifs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/An_introduction_to_ssifs.html">An introduction to the Stochastic Search Inconsistency Factor Selection method using the ssifs package</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/georgiosseitidis/ssifs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Stochastic Search Inconsistency Factor Selection</h1>
      <small class="dont-index">Source: <a href="https://github.com/georgiosseitidis/ssifs/blob/master/R/ssifs.R" class="external-link"><code>R/ssifs.R</code></a></small>
      <div class="d-none name"><code>ssifs.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Stochastic Search Inconsistency Factor Selection evaluates the consistency assumption of Network Meta-Analysis in the Bayesian framework,
by treating the inconsistency detection as a variable selection problem. The consistency assumption is evaluated locally, but also globally.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ssifs</span><span class="op">(</span></span>
<span>  <span class="va">TE</span>,</span>
<span>  <span class="va">seTE</span>,</span>
<span>  <span class="va">treat1</span>,</span>
<span>  <span class="va">treat2</span>,</span>
<span>  <span class="va">studlab</span>,</span>
<span>  <span class="va">ref</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"DBT"</span>,</span>
<span>  rpcons <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcons <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  zellner <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  c <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  psi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  M <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  n_thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  M_pilot <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  B_pilot <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  n_thin_pilot <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_chains_pilot <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-te">TE<a class="anchor" aria-label="anchor" href="#arg-te"></a></dt>
<dd><p>Estimate of treatment effect (e.g. log odds ratio, mean difference, or log hazard ratio).</p></dd>


<dt id="arg-sete">seTE<a class="anchor" aria-label="anchor" href="#arg-sete"></a></dt>
<dd><p>Standard error of the treatment estimate.</p></dd>


<dt id="arg-treat-">treat1<a class="anchor" aria-label="anchor" href="#arg-treat-"></a></dt>
<dd><p>Label/Number of the first treatment.</p></dd>


<dt id="arg-treat-">treat2<a class="anchor" aria-label="anchor" href="#arg-treat-"></a></dt>
<dd><p>Label/Number of the second treatment.</p></dd>


<dt id="arg-studlab">studlab<a class="anchor" aria-label="anchor" href="#arg-studlab"></a></dt>
<dd><p>Study labels.</p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>Reference treatment.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method used for the specification of the inconsistency factors; Possible choices are:</p><ul><li><p><code>"LuAdes"</code> for the Lu &amp; Ades model (Lu &amp; Ades, 2006)</p></li>
<li><p><code>"DBT"</code> for the design-by-treatment method (Higgins et al., 2012)</p></li>
<li><p><code>"Jackson"</code> for the random-effects implementation of the design-by-treatment model (Jackson et al., 2014)</p></li>
</ul></dd>


<dt id="arg-rpcons">rpcons<a class="anchor" aria-label="anchor" href="#arg-rpcons"></a></dt>
<dd><p><code>"logical"</code>. If <code>TRUE</code>, an informative beta distribution Beta(157, 44) is used for the probability to have a consistent network.</p></dd>


<dt id="arg-pcons">pcons<a class="anchor" aria-label="anchor" href="#arg-pcons"></a></dt>
<dd><p>Probability to have a consistent network.</p></dd>


<dt id="arg-zellner">zellner<a class="anchor" aria-label="anchor" href="#arg-zellner"></a></dt>
<dd><p><code>"logical"</code>. If <code>TRUE</code>, Zellner g-prior is used for the dependency between the inconsistency factors. If <code>FALSE</code>, inconsistency factors assumed independent.</p></dd>


<dt id="arg-c">c<a class="anchor" aria-label="anchor" href="#arg-c"></a></dt>
<dd><p>Tuning parameter.</p></dd>


<dt id="arg-psi">psi<a class="anchor" aria-label="anchor" href="#arg-psi"></a></dt>
<dd><p>Tuning parameter.</p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Digits of the exported results.</p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Number of NMA MCMC iterations.</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Burn-in period of the NMA MCMC run.</p></dd>


<dt id="arg-n-thin">n_thin<a class="anchor" aria-label="anchor" href="#arg-n-thin"></a></dt>
<dd><p>Thinning interval of the NMA MCMC run.</p></dd>


<dt id="arg-n-chains">n_chains<a class="anchor" aria-label="anchor" href="#arg-n-chains"></a></dt>
<dd><p>Number of parallel chains for the NMA MCMC run.</p></dd>


<dt id="arg-m-pilot">M_pilot<a class="anchor" aria-label="anchor" href="#arg-m-pilot"></a></dt>
<dd><p>Number of pilot MCMC iterations.</p></dd>


<dt id="arg-b-pilot">B_pilot<a class="anchor" aria-label="anchor" href="#arg-b-pilot"></a></dt>
<dd><p>Burn-in period of the pilot MCMC run.</p></dd>


<dt id="arg-n-thin-pilot">n_thin_pilot<a class="anchor" aria-label="anchor" href="#arg-n-thin-pilot"></a></dt>
<dd><p>Thinning interval of the pilot MCMC run.</p></dd>


<dt id="arg-n-chains-pilot">n_chains_pilot<a class="anchor" aria-label="anchor" href="#arg-n-chains-pilot"></a></dt>
<dd><p>Number of parallel chains for the pilot MCMC run.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following components:</p>
<dl><dt>MCMC_run</dt>
<dd><p>An object of class <code>rjags</code> containing the MCMC run of the NMA model.</p></dd>

<dt>Bayes_Factor</dt>
<dd><p>Bayes factor of the consistent NMA model over the inconsistent NMA model.</p></dd>

<dt>Posterior_inclusion_probabilities</dt>
<dd><p>A <code>data.frame</code> containing the posterior inclusion
probabilities of the inconsistency factors. Columns <code>Comparison</code> and <code>Design</code> denote in which comparisons
inconsistency factors are added. When argument <code>method = "LuAdes"</code>, column <code>Design</code> is <code>NA</code>,
because only loop inconsistencies are accounted.
<code>PIP</code> denotes the estimated posterior inclusion probability, <code>b</code> the estimated median effect
 of the inconsistency factors, <code>b.lb</code> and <code>b.ub</code> the lower and upper bounds of the inconsistency factors' effect estimates,
 respectively.</p></dd>

<dt>Posterior_Odds</dt>
<dd><p>A <code>data.frame</code> containing the model posterior odds. Column <code>IFs</code> denotes
 in which comparisons inconsistency factors are added, <code>Freq</code> the number of times the model is observed in
 the MCMC run, <code>f(m|y)</code> the posterior model probability and <code>PO_IFCONS</code> the posterior model odds
 of the consistent NMA model (denoted as <code>NO IFs</code>) over the corresponding inconsistent NMA model.</p></dd>

<dt>Summary</dt>
<dd><p>A <code>data.frame</code> containing the summary estimates of the MCMC run of the NMA model.</p></dd>

<dt>Z_matrix</dt>
<dd><p>A <code>data.frame</code> containing in the first 3 columns the treatment comparisons used for
 the Z matrix and the Z matrix in the rest columns.</p></dd>

<dt>disconnected_studies</dt>
<dd><p>A vector with the studies that were excluded in order to have
 a connected network.</p></dd>

<dt>n_subnetworks</dt>
<dd><p>Number of sub-networks.</p></dd>

<dt>subnetworks</dt>
<dd><p>A list with the sub-networks of the original NMA data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Stochastic Search Inconsistency Factor Selection (SSIFS) is the extension of Stochastic Search Variable Selection (SSVS)
(George &amp; McCulloch, 1993) for identifying inconsistencies in Network Meta-Analysis (NMA).</p>
<p>SSIFS (Seitidis et al., 2022), is a two-step method in which the inconsistency factors are specified in the first step, and in the second step,
SSVS is performed on the inconsistency factors. The method used for the specification of the inconsistency factors, is
controlled by the argument <code>method</code>. Among the choices that may be considered are the Lu and Ades model (Lu &amp; Ades, 2006),
the design-by-treatment model (Higgins et al., 2012), and the random-effects implementation of the design-by-treatment model (Jackson et al., 2014).</p>
<p>After specifying the inconsistency factors, the random-effects NMA model is implemented in the Bayesian framework using the <code>R2jags</code> package.
An uninformative normal is assumed for the prior distribution of the treatment effects, while for the heterogeneity parameter tau, an uninformative half-normal is assumed.
The function provides the MCMC run of the NMA model (item <code>MCMC_run</code>), whereby the user can check the convergence of the MCMC run.</p>
<p>SSIFS by default assumes that inconsistency factors are dependent by using a Zellner g-prior to describe this dependency (<code>zellner = TRUE</code>).
Parameter g in the Zellner g-prior is specified using the unit information criterion (Kass &amp; Wasserman, 1995), which is translated in
SSIFS to the total number of observed comparisons that are included in the network. By setting the argument <code>zellner = FALSE</code>, inconsistency factors are assumed independent.
Regarding the inclusion probabilities, the function by default assumes an informative Beta distribution (Beta(157, 44)) for the probability to have a
consistent network (<code>rpcons = TRUE</code>). In the case where <code>rpcons = FALSE</code>, this probability is assumed fixed and equal to 0.5 (<code>pcons = 0.5</code>).
The user can modify this probability through the argument <code>pcons</code>.</p>
<p>Tuning parameters in SSIFS are specified by the arguments <code>c</code> and <code>psi</code>. They should be specified in a way that, when
an inconsistency factor is included in the NMA model, the corresponding coefficient lies in an area close to zero,
and far away from this area when it is not included in the NMA model. Regarding the argument <code>c</code>, values between 10 and 100
usually perform well in most cases. Argument <code>psi</code> can be obtained either from a pilot MCMC run of the NMA model, as the
standard deviation of the inconsistency factors (<code>psi = NULL</code>), or can be set fixed a-priory by the analyst.</p>
<p>In order to evaluate the consistency assumption, we can examine</p><ul><li><p>the posterior inclusion probabilities
of the inconsistency factors (item <code>Posterior_inclusion_probabilities</code>)</p></li>
<li><p>the posterior model probabilities (item <code>Posterior_Odds</code>)</p></li>
<li><p>the posterior model odds (item <code>Posterior_Odds</code>)</p></li>
<li><p>the Bayes factor of the consistent NMA model over the inconsistent NMA models (item <code>Bayes_Factor</code>)</p></li>
</ul><p>A posterior inclusion probability above 0.5 indicates inconsistency.
Also, an inconsistent NMA model with large posterior model probability suggests the presence of inconsistency. Item <code>Bayes_Factor</code>
provides a global test for testing the consistency assumption, by calculating the Bayes factor of the consistent NMA model (model without inconsistency factors) over the
rest inconsistent NMA models that  were observed in the MCMC run. An estimate above 1 favors the consistent NMA model.
For the calculation of the Bayes factor, the inconsistent NMA models are treated as a single model and the corresponding
posterior model probabilities are summed.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The function uses the random-effects inverse-variance NMA model, and assumes common heterogeneity between different treatment comparisons
and no correlation between different studies. Additionally, when the network is disconnected, the function keeps only those studies that
belong to the largest sub-network.</p>
<p>In a multi-arm study with T comparisons, T-1 are required for the NMA model since the rest are obtained as a linear combination.
The function automatically excludes the unnecessary comparisons, while maintaining the basic comparisons (if possible)
and comparisons in which an inconsistency factor has been added. Therefore, all possible comparisons
of multi-arm studies must be provided by the user.</p>
<p>For the names of the inconsistency factor, treatments are separated by the symbol <code>" ; "</code>. For example, if an inconsistency
factor is added in the comparison between treatments A and B, the inconsistency factor name will be <code>A ; B</code>.
In the case where <code>method = "DBT"</code> or <code>method = "Jackson"</code>, inconsistency factors' names for multi-arm designs are
denoted as <em>treatment.comparison</em>_<em>design</em>. Thus, if an inconsistency factor is added in the comparison
between treatments A and B of the ABC design, the inconsistency factor name will be <code>A ; B_ABC</code>.</p>
<p>In extremely large networks, the number of paths between two nodes may be exponentially high. If your network is lattice-like,
you may run out of memory during the specification of the inconsistency factors with the Lu and Ades model.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>George, E. I., &amp; McCulloch, R. E. (1993):
Variable selection via Gibbs sampling.
<em>Journal of the American Statistical Association</em>,
<b>88</b>(423), 881-889.</p>
<p>Seitidis, G., Nikolakopoulos, S., Ntzoufras, I., &amp; Mavridis, D. (2022):
Inconsistency identification in network meta-analysis via stochastic search variable selection.
<em>arXiv preprint</em>,
<b>arXiv:2211.07258</b>.</p>
<p>Lu, G., &amp; Ades, A. E. (2006):
Assessing evidence inconsistency in mixed treatment comparisons.
<em>Journal of the American Statistical Association</em>,
<b>101</b>(474), 447-459.</p>
<p>Higgins, J. P. T., Jackson, D., Barrett, J. K., Lu, G., Ades, A. E., &amp; White, I. R. (2012):
Consistency and inconsistency in network meta-analysis: concepts and models for multi-arm studies.
<em>Research synthesis methods</em>,
<b>3</b>(2), 98-110.</p>
<p>Jackson, D., Barrett, J. K., Rice, S., White, I. R., &amp; Higgins, J. P. (2014):
A design-by-treatment interaction model for network meta-analysis with random inconsistency effects.
<em>Statistics in medicine</em>,
<b>33</b>(21), 3639-3654.</p>
<p>Kass, R. E., &amp; Wasserman, L. (1995):
A Reference Bayesian Test for Nested Hypotheses and its Relationship to the Schwarz Criterion.
<em>Journal of the American Statistical Association</em>,
<b>90</b>(431), 928–934.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Alcohol</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">TE</span> <span class="op">&lt;-</span> <span class="va">Alcohol</span><span class="op">$</span><span class="va">TE</span></span></span>
<span class="r-in"><span><span class="va">seTE</span> <span class="op">&lt;-</span> <span class="va">Alcohol</span><span class="op">$</span><span class="va">seTE</span></span></span>
<span class="r-in"><span><span class="va">studlab</span> <span class="op">&lt;-</span> <span class="va">Alcohol</span><span class="op">$</span><span class="va">studyid</span></span></span>
<span class="r-in"><span><span class="va">treat1</span> <span class="op">&lt;-</span> <span class="va">Alcohol</span><span class="op">$</span><span class="va">treat2</span></span></span>
<span class="r-in"><span><span class="va">treat2</span> <span class="op">&lt;-</span> <span class="va">Alcohol</span><span class="op">$</span><span class="va">treat1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Stochastic Search Inconsistency Factor Selection using intervention AO-CT as reference.</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">ssifs</span><span class="op">(</span><span class="va">TE</span>, <span class="va">seTE</span>, <span class="va">treat1</span>, <span class="va">treat2</span>, <span class="va">studlab</span>, ref <span class="op">=</span> <span class="st">"AO-CT"</span>, M<span class="op">=</span><span class="fl">1000</span>, B<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Georgios Seitidis, Stavros Nikolakopoulos, Ioannis Ntzoufras, Dimitris Mavridis.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

